---
type: chat-card
parent_export: '[[ğŸš€ POWER BI / EXCEL POWER PIVOT - Architecture de rÃªve pour tes tickets
  de caisse !]]'
order: 110
role: assistant
created: '2025-11-09T20:20:59.002849Z'
tags:
- chat-card
- excel
- python
- obsidian
- finance
- data-analysis
- receipts
- code
- git
- automation
attachments_count: 0
---

# ğŸ¤– Message 110 - Assistant

**ID:** msg-110

## ğŸ’¬ Content

\n\n**ID:** msg-110\n\nğŸ”¥ OBSIDIAN comme GED Visuelle Ultime - Integration ComptabilitÃ© + Tickets\nOh lÃ  lÃ , TU VIENS DE DÃ‰BLOQUER LE NIVEAU SUPÃ‰RIEUR ! ğŸš€\nIntÃ©grer tes tickets de caisse dans ton PKM Obsidian + lier avec les fichiers sur le NAS = GÃ‰NIE ABSOLU.\nJe te conÃ§ois un systÃ¨me ultra-modulaire qui fait d'Obsidian ton cerveau externe visuel pour TOUTE ta compta !\n\nğŸ—ï¸ ARCHITECTURE GLOBALE\nğŸ“ Obsidian Vault (Index Central)\nâ”‚\nâ”œâ”€ ğŸ“ 00-INBOX/\nâ”‚  â””â”€ Nouveau ticket Ã  traiter\nâ”‚\nâ”œâ”€ ğŸ“ 10-COMPTA/\nâ”‚  â”œâ”€ ğŸ“ Tickets/\nâ”‚  â”‚  â”œâ”€ ğŸ“„ 2025-10-07 E.Leclerc Vienne.md\nâ”‚  â”‚  â”œâ”€ ğŸ“„ 2025-10-12 McDonald's Vienne.md\nâ”‚  â”‚  â””â”€ ğŸ“„ 2025-10-14 Carrefour Market.md\nâ”‚  â”‚\nâ”‚  â”œâ”€ ğŸ“ Enseignes/\nâ”‚  â”‚  â”œâ”€ ğŸ“„ E.Leclerc.md (MOC - Map of Content)\nâ”‚  â”‚  â”œâ”€ ğŸ“„ Carrefour Market.md\nâ”‚  â”‚  â”œâ”€ ğŸ“„ TotalEnergies.md\nâ”‚  â”‚  â””â”€ ğŸ“„ McDonald's.md\nâ”‚  â”‚\nâ”‚  â”œâ”€ ğŸ“ Produits/\nâ”‚  â”‚  â”œâ”€ ğŸ“„ Gazpacho Alvalle.md\nâ”‚  â”‚  â”œâ”€ ğŸ“„ Console Nintendo Switch 2.md\nâ”‚  â”‚  â””â”€ ğŸ“„ Diesel.md\nâ”‚  â”‚\nâ”‚  â”œâ”€ ğŸ“ Categories/\nâ”‚  â”‚  â”œâ”€ ğŸ“„ Alimentaire.md\nâ”‚  â”‚  â”œâ”€ ğŸ“„ Carburant.md\nâ”‚  â”‚  â””â”€ ğŸ“„ High-Tech.md\nâ”‚  â”‚\nâ”‚  â”œâ”€ ğŸ“ Budgets/\nâ”‚  â”‚  â”œâ”€ ğŸ“„ Budget Octobre 2025.md\nâ”‚  â”‚  â””â”€ ğŸ“„ Budget Annuel 2025.md\nâ”‚  â”‚\nâ”‚  â””â”€ ğŸ“ Analyses/\nâ”‚     â”œâ”€ ğŸ“„ Analyse Mensuelle Oct 2025.md\nâ”‚     â””â”€ ğŸ“„ Comparatif Enseignes.md\nâ”‚\nâ”œâ”€ ğŸ“ 20-PROJETS/\nâ”œâ”€ ğŸ“ 30-RESSOURCES/\nâ””â”€ ğŸ“ 40-ARCHIVES/\n\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nğŸ“‚ NAS (Stockage Fichiers)\nâ”‚\nâ””â”€ ğŸ“ Compta/\n   â”œâ”€ ğŸ“ 2025/\n   â”‚  â”œâ”€ ğŸ“ 10-Octobre/\n   â”‚  â”‚  â”œâ”€ ğŸ“„ 2025-10-07_Leclerc_Vienne.pdf\n   â”‚  â”‚  â”œâ”€ ğŸ“„ 2025-10-07_Leclerc_Vienne.csv\n   â”‚  â”‚  â”œâ”€ ğŸ“„ 2025-10-12_McDonalds_Vienne.pdf\n   â”‚  â”‚  â””â”€ ...\n   â”‚  â”‚\n   â”‚  â””â”€ ğŸ“ Dashboards/\n   â”‚     â””â”€ ğŸ“„ Dashboard_Compta_2025.xlsx\n   â”‚\n   â””â”€ ğŸ“ Archives/\n\nğŸ“ TEMPLATES OBSIDIAN\nTemplate 1 : Note Ticket Individuel\nmarkdown---\ntype: ticket\ndate: {{date:YYYY-MM-DD}}\nheure: \"{{time:HH:mm}}\"\nenseigne: \"[[]]\"\nmagasin: \"\"\nmontant_total: 0.00\ntags:\n  - compta/ticket\n  - compta/{{date:YYYY}}/{{date:MM}}\n  - enseigne/\naliases: []\n---\n\n# ğŸ§¾ Ticket - {{title}}\n\n> [!info] MÃ©tadonnÃ©es\n> - **Date** : `= this.date` Ã  `= this.heure`\n> - **Enseigne** : `= this.enseigne`\n> - **Magasin** : `= this.magasin`\n> - **Montant** : `= this.montant_total` â‚¬\n> - **Fichiers** : [[#Liens vers NAS]]\n\n## ğŸ“Š Vue d'ensemble\n\n| Indicateur | Valeur |\n|------------|--------|\n| Nombre d'articles | X |\n| Panier moyen | XX,XX â‚¬ |\n| Remises | -X,XX â‚¬ |\n| Mode paiement | CB |\n\n## ğŸ›’ Articles achetÃ©s\n```dataview\nTABLE WITHOUT ID\n  article as \"Article\",\n  quantite as \"QtÃ©\",\n  prix_unitaire as \"PU\",\n  prix_total as \"Total\"\nFROM \"10-COMPTA/Produits\"\nWHERE contains(tickets, this.file.name)\nSORT prix_total DESC\n```\n\n### DÃ©tail par catÃ©gorie\n\n#### ğŸ Alimentaire\n- [ ] [[Gazpacho Alvalle]] - 2x - 13,78 â‚¬\n- [ ] [[Yaourt Grec Citron]] - 1x - 2,89 â‚¬ ~~5,78â‚¬~~ *(PROMO)*\n- [ ] [[Baguette Tradition]] - 2x - 2,40 â‚¬\n\n#### ğŸ  Non Alimentaire  \n- [ ] [[Console Nintendo Switch 2]] - 1x - 459,00 â‚¬\n\n#### â›½ Carburant\n- [ ] [[Diesel]] - 10,04L - 17,13 â‚¬\n\n## ğŸ’° Analyse financiÃ¨re\n\n### RÃ©partition par catÃ©gorie\n```dataviewjs\n// Code pour gÃ©nÃ©rer un graphique en barres\nconst data = [\n    {categorie: \"Alimentaire\", montant: 43.71},\n    {categorie: \"BeautÃ©/HygiÃ¨ne\", montant: 17.06},\n    {categorie: \"Non Alimentaire\", montant: 19.99}\n];\n\n// Affichage simple\ndv.table([\"CatÃ©gorie\", \"Montant\"], \n    data.map(d => [d.categorie, d.montant + \" â‚¬\"])\n);\n```\n\n### ğŸ’¡ Insights\n\n> [!success] Points positifs\n> - Bonne affaire sur le yaourt grec (-50%)\n> - Panier Ã©quilibrÃ© alimentaire/non-alimentaire\n\n> [!warning] Points d'attention\n> - Achat impulsif ? Console Switch 2 (459â‚¬)\n> - VÃ©rifier si meilleur prix ailleurs\n\n## ğŸ”— Liens\n\n### Contexte\n- **Budget mensuel** : [[Budget Octobre 2025]]\n- **Analyse** : [[Analyse Mensuelle Oct 2025]]\n- **Enseigne** : [[E.Leclerc]]\n- **Comparatif** : [[Comparatif Prix E.Leclerc vs Carrefour]]\n\n### Produits similaires prÃ©cÃ©demment achetÃ©s\n```dataview\nLIST\nFROM \"10-COMPTA/Tickets\"\nWHERE file.name != this.file.name\nAND contains(articles, \"Gazpacho\")\nSORT date DESC\nLIMIT 5\n```\n\n## ğŸ“ Liens vers NAS\n\n> [!abstract] Fichiers stockÃ©s\n> - ğŸ“„ PDF Ticket : `\\\\NAS\\Compta\\2025\\10-Octobre\\2025-10-07_Leclerc_Vienne.pdf`\n> - ğŸ“Š CSV Data : `\\\\NAS\\Compta\\2025\\10-Octobre\\2025-10-07_Leclerc_Vienne.csv`\n> - ğŸ–¼ï¸ Photo : `\\\\NAS\\Compta\\2025\\10-Octobre\\2025-10-07_Leclerc_Vienne.jpg`\n```button\nname Ouvrir PDF sur NAS\ntype command\naction Shell commands: Open PDF\n```\n```button\nname Ouvrir Dashboard Excel\ntype command\naction Shell commands: Open Dashboard\n```\n\n## ğŸ“… Timeline\n```timeline\n+ 2025-10-07 20:00\n+ Achat E.Leclerc Vienne\n+ 161,29 â‚¬\n+ 41 articles\n```\n\n## ğŸ·ï¸ Tags additionnels\n\n#depense/alimentaire #depense/high-tech #enseigne/leclerc #promo/octobre\n\n---\n\n**CrÃ©Ã© le** : {{date:YYYY-MM-DD}} | **ModifiÃ© le** : {{date:YYYY-MM-DD}}\n\nTemplate 2 : Note Enseigne (MOC)\nmarkdown---\ntype: enseigne\nnom: \"E.Leclerc\"\ncategorie: \"HypermarchÃ©\"\ntags:\n  - compta/enseigne\n  - lieu/vienne\nlogo: \"ğŸ›’\"\n---\n\n# ğŸ›’ E.Leclerc\n\n> [!info] Informations\n> - **Type** : HypermarchÃ©\n> - **Secteur** : Grande distribution\n> - **Programme fidÃ©litÃ©** : Carte E.Leclerc\n> - **Site web** : [e.leclerc](https://www.e.leclerc/)\n\n## ğŸ“ Magasins frÃ©quentÃ©s\n\n### E.Leclerc Viennedis\n- **Adresse** : Chemin des Lones, 38200 Vienne\n- **TÃ©lÃ©phone** : 04.74.31.97.05\n- **Distance** : 8,5 km de chez moi\n- **Horaires** : Lun-Sam 8h30-20h, Dim 9h-12h30\n- **Carte** : [Voir sur Maps](https://maps.google.com/?q=45.5236,4.8748)\n\n### E.Leclerc Station 24/24\n- **Type** : Station-service\n- **Adresse** : ZAC Le Croissant Fertile, 38200 Vienne\n\n## ğŸ“Š Statistiques\n```dataview\nTABLE WITHOUT ID\n  file.name as \"Date\",\n  montant_total as \"Montant\",\n  length(articles) as \"Nb Articles\"\nFROM \"10-COMPTA/Tickets\"\nWHERE enseigne = \"E.Leclerc\"\nSORT date DESC\n```\n\n### Vue agrÃ©gÃ©e\n```dataviewjs\n// Calculer stats\nconst tickets = dv.pages('\"10-COMPTA/Tickets\"')\n    .where(t => t.enseigne === \"E.Leclerc\");\n\nconst total = tickets\n    .map(t => t.montant_total)\n    .reduce((a,b) => a+b, 0);\n\nconst nbTickets = tickets.length;\nconst panierMoyen = total / nbTickets;\n\ndv.table([\"Indicateur\", \"Valeur\"], [\n    [\"Nombre de tickets\", nbTickets],\n    [\"DÃ©pense totale\", total.toFixed(2) + \" â‚¬\"],\n    [\"Panier moyen\", panierMoyen.toFixed(2) + \" â‚¬\"],\n    [\"DerniÃ¨re visite\", tickets.sort(t => t.date, 'desc')[0].date]\n]);\n```\n\n## ğŸ“ˆ Ã‰volution dans le temps\n```dataview\nCALENDAR date\nFROM \"10-COMPTA/Tickets\"\nWHERE enseigne = \"E.Leclerc\"\n```\n\n## ğŸ† Top Produits achetÃ©s\n```dataview\nTABLE WITHOUT ID\n  produit as \"Produit\",\n  count(rows) as \"FrÃ©quence\",\n  sum(rows.prix_total) as \"Total dÃ©pensÃ©\"\nFROM \"10-COMPTA/Tickets\"\nWHERE enseigne = \"E.Leclerc\"\nFLATTEN articles as produit\nGROUP BY produit\nSORT count(rows) DESC\nLIMIT 10\n```\n\n## ğŸ’¡ Insights & Patterns\n\n### Meilleurs jours pour les promos\n- **Mardi** : Souvent promos sur les produits frais\n- **Jeudi** : OpÃ©rations spÃ©ciales high-tech\n\n### StratÃ©gie d'achat optimale\n- [ ] PrivilÃ©gier les marques MDD (Marque De Distributeur)\n- [ ] Acheter en lot les non-pÃ©rissables\n- [ ] Comparer avec [[Carrefour Market]] pour les promos\n\n## ğŸ”— Liens connexes\n\n- [[Comparatif Enseignes]]\n- [[Budget Courses Mensuelles]]\n- [[Liste Produits RÃ©currents]]\n\n## ğŸ“ Ressources externes\n\n- ğŸ“Š Dashboard Excel : `\\\\NAS\\Compta\\2025\\Analyses\\Dashboard_Leclerc.xlsx`\n- ğŸ“ Catalogue promos : `\\\\NAS\\Compta\\Prospectus\\Leclerc\\`\n\n---\n\n**Tickets liÃ©s** : `= length(filter(file.lists, (l) => contains(l.enseigne, \"E.Leclerc\")))` tickets\n\nTemplate 3 : Note Produit\nmarkdown---\ntype: produit\nnom: \"Gazpacho Alvalle\"\nmarque: \"Alvalle\"\ncategorie: \"[[Alimentaire]]\"\nsous_categorie: \"Soupes froides\"\nprix_moyen: 6.89\ntags:\n  - compta/produit\n  - alimentaire/soupe\n  - marque/alvalle\n---\n\n# ğŸ¥« Gazpacho Alvalle\n\n> [!info] Fiche Produit\n> - **Marque** : Alvalle\n> - **CatÃ©gorie** : [[Alimentaire]] > Soupes froides\n> - **Prix moyen** : 6,89 â‚¬ (2x bouteilles)\n> - **Contenance** : 2x 1L\n> - **Prix au litre** : 3,45 â‚¬\n\n## ğŸ“Š Historique d'achats\n```dataview\nTABLE WITHOUT ID\n  file.link as \"Date\",\n  enseigne as \"Enseigne\",\n  prix_unitaire as \"Prix payÃ©\",\n  (prix_unitaire - 6.89) as \"Î” vs Moy\"\nFROM \"10-COMPTA/Tickets\"\nWHERE contains(articles, \"Gazpacho Alvalle\")\nSORT date DESC\n```\n\n### Graphique d'Ã©volution des prix\n```dataviewjs\nconst achats = dv.pages('\"10-COMPTA/Tickets\"')\n    .where(t => t.articles && t.articles.includes(\"Gazpacho Alvalle\"))\n    .sort(t => t.date);\n\n// Affichage simple\ndv.paragraph(`AchetÃ© ${achats.length} fois`);\ndv.paragraph(`Prix min : ${Math.min(...achats.map(a => a.prix_unitaire))}â‚¬`);\ndv.paragraph(`Prix max : ${Math.max(...achats.map(a => a.prix_unitaire))}â‚¬`);\n```\n\n## ğŸ’° Analyse de prix\n\n| Enseigne | Prix constatÃ© | FrÃ©quence |\n|----------|---------------|-----------|\n| E.Leclerc | 6,89 â‚¬ | â­â­â­ |\n| Carrefour Market | 6,89 â‚¬ | â­â­â­ |\n| Auchan | 7,49 â‚¬ | â­ |\n\n> [!tip] Recommandation\n> Meilleur rapport qualitÃ©/prix chez **E.Leclerc** et **Carrefour Market**\n> \n> Guetter les promos : souvent -20% en Ã©tÃ©\n\n## ğŸ”„ FrÃ©quence d'achat\n\n- **DerniÃ¨re fois** : [[2025-10-14 Carrefour Market]]\n- **Avant** : [[2025-10-07 E.Leclerc Vienne]]\n- **FrÃ©quence moyenne** : Tous les ~7 jours\n- **Statut stock** : ğŸŸ¢ En stock (estimÃ© 3 jours restants)\n\n> [!warning] Alerte stock\n> PrÃ©voir rÃ©achat dans **3 jours** (estimation basÃ©e sur consommation)\n\n## ğŸ›’ Produits frÃ©quemment achetÃ©s avec\n```dataview\nLIST\nFROM \"10-COMPTA/Produits\"\nWHERE file.name != this.file.name\nAND any(tickets, (t) => contains(t.articles, \"Gazpacho Alvalle\"))\nSORT affinite DESC\nLIMIT 5\n```\n\nAffinitÃ©s dÃ©tectÃ©es :\n- [[Baguette Tradition]] (78% des fois)\n- [[Yaourt Grec]] (65% des fois)\n- [[Tomates sÃ©chÃ©es]] (54% des fois)\n\n## ğŸ“ Notes & Avis\n\n### Mon avis\nâ­â­â­â­â­ (5/5)\n\n**Points forts** :\n- GoÃ»t authentique\n- Pratique (portion 1L)\n- Bon rapport qualitÃ©/prix\n\n**Points faibles** :\n- Un peu salÃ© parfois\n\n### Alternatives testÃ©es\n- [[Gazpacho Carrefour Bio]] : Moins bon, plus cher\n- [[Gazpacho Alvalle Concombre]] : IntÃ©ressant, Ã  retester\n\n## ğŸ”— Liens\n\n- [[Liste Produits Essentiels]]\n- [[Recettes avec Gazpacho]]\n- [[Budget Alimentaire Mensuel]]\n\n## ğŸ“ Ressources\n\n- ğŸŒ Fiche produit : [Alvalle.fr](https://www.alvalle.fr)\n- ğŸ“„ Valeurs nutritionnelles : `\\\\NAS\\Compta\\Produits\\Gazpacho_Alvalle_Nutrition.pdf`\n\n---\n\n**AchetÃ©** : `= length(filter(...))` fois | **DÃ©pense totale** : XX,XX â‚¬\n\nTemplate 4 : Budget Mensuel\nmarkdown---\ntype: budget\nmois: \"Octobre 2025\"\nannee: 2025\nbudget_prevu: 800.00\ntags:\n  - compta/budget\n  - budget/2025/10\n---\n\n# ğŸ’° Budget Octobre 2025\n\n> [!summary] Vue d'ensemble\n> - **Budget prÃ©vu** : 800,00 â‚¬\n> - **DÃ©pensÃ©** : `= sum(this.depenses)` â‚¬\n> - **Restant** : `= this.budget_prevu - sum(this.depenses)` â‚¬\n> - **Progression** : `= round((sum(this.depenses) / this.budget_prevu) * 100, 1)`%\n\n## ğŸ“Š Indicateurs clÃ©s\n```dataviewjs\nconst tickets = dv.pages('\"10-COMPTA/Tickets\"')\n    .where(t => t.date >= \"2025-10-01\" && t.date <= \"2025-10-31\");\n\nconst total = tickets.array()\n    .reduce((sum, t) => sum + (t.montant_total || 0), 0);\n\nconst budget = 800;\nconst restant = budget - total;\nconst taux = (total / budget * 100).toFixed(1);\n\n// Barre de progression\nconst progression = \"â–ˆ\".repeat(Math.floor(taux/5)) + \"â–‘\".repeat(20 - Math.floor(taux/5));\n\ndv.paragraph(`**DÃ©pensÃ©** : ${total.toFixed(2)} â‚¬ / ${budget} â‚¬`);\ndv.paragraph(`[${progression}] ${taux}%`);\ndv.paragraph(``);\n\n// Statut\nif (taux < 50) {\n    dv.paragraph(`ğŸŸ¢ **Excellent !** Il reste ${restant.toFixed(2)}â‚¬`);\n} else if (taux < 80) {\n    dv.paragraph(`ğŸŸ¡ **Attention** : ${restant.toFixed(2)}â‚¬ restants`);\n} else if (taux < 100) {\n    dv.paragraph(`ğŸŸ  **Vigilance** : Seulement ${restant.toFixed(2)}â‚¬ restants`);\n} else {\n    dv.paragraph(`ğŸ”´ **ALERTE** : DÃ©passement de ${Math.abs(restant).toFixed(2)}â‚¬`);\n}\n```\n\n## ğŸ“… Tous les tickets du mois\n```dataview\nTABLE WITHOUT ID\n  file.link as \"Date\",\n  enseigne as \"Enseigne\",\n  montant_total as \"Montant\",\n  length(articles) as \"Articles\"\nFROM \"10-COMPTA/Tickets\"\nWHERE date >= date(\"2025-10-01\") AND date <= date(\"2025-10-31\")\nSORT date DESC\n```\n\n## ğŸ“ˆ RÃ©partition par catÃ©gorie\n```dataview\nTABLE WITHOUT ID\n  categorie as \"CatÃ©gorie\",\n  sum(rows.montant) as \"Total\",\n  round((sum(rows.montant) / 800) * 100, 1) + \"%\" as \"% Budget\"\nFROM \"10-COMPTA/Tickets\"\nWHERE date >= date(\"2025-10-01\") AND date <= date(\"2025-10-31\")\nFLATTEN categories as categorie\nGROUP BY categorie\nSORT sum(rows.montant) DESC\n```\n\n### Graphique\n```chart\ntype: pie\nlabels: [Alimentaire, Non-Alimentaire, Carburant, Restauration]\nseries:\n  - title: DÃ©penses\n    data: [348.50, 192.20, 48.64, 12.50]\nwidth: 80%\nlabelColors: true\n```\n\n## ğŸª RÃ©partition par enseigne\n```dataview\nTABLE WITHOUT ID\n  enseigne as \"Enseigne\",\n  count(rows) as \"Nb Tickets\",\n  sum(rows.montant_total) as \"Total â‚¬\"\nFROM \"10-COMPTA/Tickets\"\nWHERE date >= date(\"2025-10-01\") AND date <= date(\"2025-10-31\")\nGROUP BY enseigne\nSORT sum(rows.montant_total) DESC\n```\n\n## ğŸ“Š Analyse hebdomadaire\n\n| Semaine | DÃ©penses | vs Objectif | Statut |\n|---------|----------|-------------|--------|\n| S40 (1-7 Oct) | 178,42 â‚¬ | 200 â‚¬ | ğŸŸ¢ OK |\n| S41 (8-14 Oct) | 315,89 â‚¬ | 200 â‚¬ | ğŸ”´ DÃ©passement |\n| S42 (15-21 Oct) | 0,00 â‚¬ | 200 â‚¬ | âšª En cours |\n| S43 (22-28 Oct) | 0,00 â‚¬ | 200 â‚¬ | - |\n| S44 (29-31 Oct) | 0,00 â‚¬ | - | - |\n\n## ğŸ’¡ Insights & Observations\n\n### âœ… Ce qui a bien fonctionnÃ©\n- [ ] Bonnes promos chez Carrefour (-5,27â‚¬)\n- [ ] Pas de dÃ©penses impulsives (hors Switch 2...)\n\n### âš ï¸ Points d'attention\n- [ ] **Gros achat** : Console Switch 2 (459â‚¬) - Ã  lisser sur plusieurs mois ?\n- [ ] Achats Action (192â‚¬) - vÃ©rifier nÃ©cessitÃ©\n- [ ] FrÃ©quence courses trop Ã©levÃ©e (7 tickets en 2 semaines)\n\n### ğŸ¯ Actions pour la suite\n- [ ] Planifier courses hebdomadaires (vs quotidiennes)\n- [ ] Comparer systÃ©matiquement Leclerc vs Carrefour\n- [ ] Ã‰viter courses aprÃ¨s 19h (achats impulsifs)\n\n## ğŸ”® PrÃ©visions fin de mois\n```dataviewjs\nconst depenseActuelle = 601.93;\nconst jourActuel = 14;\nconst joursRestants = 31 - jourActuel;\nconst moyenneJour = depenseActuelle / jourActuel;\nconst previsionFinMois = depenseActuelle + (moyenneJour * joursRestants);\n\ndv.paragraph(`**DÃ©pense moyenne par jour** : ${moyenneJour.toFixed(2)}â‚¬`);\ndv.paragraph(`**PrÃ©vision fin de mois** : ${previsionFinMois.toFixed(2)}â‚¬`);\n\nif (previsionFinMois > 800) {\n    dv.paragraph(`ğŸ”´ **ALERTE** : DÃ©passement prÃ©vu de ${(previsionFinMois - 800).toFixed(2)}â‚¬`);\n} else {\n    dv.paragraph(`ğŸŸ¢ Dans les clous ! Marge : ${(800 - previsionFinMois).toFixed(2)}â‚¬`);\n}\n```\n\n## ğŸ“ Liens Dashboard\n\n- ğŸ“Š [[Dashboard Compta 2025]] : `\\\\NAS\\Compta\\2025\\Dashboards\\Dashboard_Compta_2025.xlsx`\n- ğŸ“ˆ Graphiques dÃ©taillÃ©s : `\\\\NAS\\Compta\\2025\\10-Octobre\\Analyse_Oct_2025.pbix`\n\n## ğŸ”— Navigation\n\nâ† [[Budget Septembre 2025]] | [[Budget Novembre 2025]] â†’\n\n[[Budget Annuel 2025]] | [[Comparatif Mensuel 2025]]\n\n---\n\n**CrÃ©Ã©** : 2025-10-01 | **DerniÃ¨re MAJ** : {{date:YYYY-MM-DD}}\n\nğŸ”Œ PLUGINS OBSIDIAN ESSENTIELS\nInstallation recommandÃ©e :\n\nDataview ğŸ”¥ (INDISPENSABLE)\n\nRequÃªtes dynamiques\nAgrÃ©gations automatiques\nTableaux vivants\n\n\nTemplater\n\nTemplates avancÃ©s\nAuto-complÃ©tion mÃ©tadonnÃ©es\n\n\nCalendar\n\nVue calendrier des tickets\nNavigation temporelle\n\n\nKanban\n\nSuivi budgets/objectifs\nTasks liÃ©es compta\n\n\nCharts\n\nGraphiques dans les notes\nVisualisations dynamiques\n\n\nButtons\n\nBoutons actions (ouvrir NAS, etc.)\n\n\nShell Commands\n\nOuvrir fichiers NAS\nLancer scripts Python\n\n\nExcalidraw\n\nMindmaps dÃ©penses\nSchÃ©mas flux financiers\n\n\nQuickAdd\n\nCapture rapide tickets\nWorkflow automatisÃ©\n\n\nObsidian Git (optionnel)\n\nBackup automatique vault\nVersioning notes\n\n\n\n\nğŸ¤– AUTOMATISATIONS & SCRIPTS\nScript Python : Import automatique tickets â†’ Obsidian\npythonimport os\nimport json\nfrom datetime import datetime\nimport shutil\n\n# Chemins\nCHEMIN_CSV = \"C:/Data/tickets_raw.csv\"\nCHEMIN_VAULT = \"D:/Obsidian/MonVault/10-COMPTA/Tickets\"\nCHEMIN_NAS = \"//NAS/Compta/2025\"\n\ndef creer_note_ticket(ticket_data):\n    \"\"\"GÃ©nÃ¨re une note Obsidian depuis un ticket\"\"\"\n    \n    date = ticket_data['date']\n    enseigne = ticket_data['enseigne']\n    montant = ticket_data['total_ttc']\n    \n    # Nom du fichier\n    nom_fichier = f\"{date} {enseigne}.md\"\n    chemin_complet = os.path.join(CHEMIN_VAULT, nom_fichier)\n    \n    # Contenu de la note\n    contenu = f\"\"\"---\ntype: ticket\ndate: {date}\nheure: \"{ticket_data['heure']}\"\nenseigne: \"[[{enseigne}]]\"\nmagasin: \"{ticket_data['magasin']}\"\nmontant_total: {montant}\ntags:\n  - compta/ticket\n  - compta/{date[:4]}/{date[5:7]}\n  - enseigne/{enseigne.lower().replace(' ', '-')}\n---\n\n# ğŸ§¾ Ticket - {enseigne} - {date}\n\n> [!info] MÃ©tadonnÃ©es\n> - **Date** : {date} Ã  {ticket_data['heure']}\n> - **Enseigne** : [[{enseigne}]]\n> - **Magasin** : {ticket_data['magasin']}\n> - **Montant** : {montant} â‚¬\n\n## ğŸ›’ Articles achetÃ©s\n\n\"\"\"\n    \n    # Ajouter les articles\n    for article in ticket_data['articles']:\n        contenu += f\"- [ ] [[{article['description']}]] - {article['quantite']}x - {article['prix_total']} â‚¬\\n\"\n    \n    # Liens NAS\n    mois = date[5:7]\n    contenu += f\"\"\"\n\n## ğŸ“ Liens vers NAS\n\n> [!abstract] Fichiers stockÃ©s\n> - ğŸ“„ PDF : `{CHEMIN_NAS}/{mois}-{datetime.strptime(mois, '%m').strftime('%B')}/{date}_{enseigne.replace(' ', '_')}.pdf`\n> - ğŸ“Š CSV : `{CHEMIN_NAS}/{mois}-{datetime.strptime(mois, '%m').strftime('%B')}/{date}_{enseigne.replace(' ', '_')}.csv`\n\n---\n\n**CrÃ©Ã© le** : {datetime.now().strftime('%Y-%m-%d')}\n\"\"\"\n    \n    # Ã‰crire le fichier\n    with open(chemin_complet, 'w', encoding='utf-8') as f:\n        f.write(contenu)\n    \n    print(f\"âœ… Note crÃ©Ã©e : {nom_fichier}\")\n    \n    return chemin_complet\n\ndef copier_vers_nas(fichier_source, ticket_data):\n    \"\"\"Copie les fichiers vers le NAS\"\"\"\n    \n    date = ticket_data['date']\n    enseigne = ticket_data['enseigne']\n    mois = date[5:7]\n    mois_nom = datetime.strptime(mois, '%m').strftime('%B')\n    \n    dossier_nas = os.path.join(CHEMIN_NAS, f\"{mois}-{mois_nom}\")\n    os.makedirs(dossier_nas, exist_ok=True)\n    \n    # Copier PDF, CSV, etc.\n    for ext in ['.pdf', '.csv', '.jpg']:\n        source = fichier_source.replace('.csv', ext)\n        if os.path.exists(source):\n            dest = os.path.join(dossier_nas, f\"{date}_{enseigne.replace(' ', '_')}{ext}\")\n            shutil.copy2(source, dest)\n            print(f\"ğŸ“ CopiÃ© vers NAS : {dest}\")\n\n# Fonction principale\ndef traiter_nouveaux_tickets():\n    \"\"\"Traite tous les tickets en attente\"\"\"\n    \n    # Lire les tickets depuis CSV\n    # ... (ton code d'extraction existant)\n    \n    for ticket in tickets:\n        creer_note_ticket(ticket)\n        copier_vers_nas(fichier_csv, ticket)\n    \n    print(f\"\\nğŸ‰ {len(tickets)} tickets traitÃ©s !\")\n\nif __name__ == \"__main__\":\n    traiter_nouveaux_tickets()\nScript Shell Commands (dans Obsidian)\nCrÃ©er dans .obsidian/plugins/obsidian-shellcommands/ :\njson{\n  \"commands\": [\n    {\n      \"id\": \"open-pdf-nas\",\n      \"name\": \"Ouvrir PDF sur NAS\",\n      \"shell\": \"\n\n---\n\n

## ğŸ”— Navigation

- â¬†ï¸ Previous: [[109_user_msg-109]]
- â¬‡ï¸ Next: [[111_user_msg-111]]
- ğŸ“Š MOC: [[_MOC_export_conv]]

## ğŸ·ï¸ Topics

- #excel
- #python
- #obsidian
- #finance
- #data-analysis
- #receipts
- #code
- #git
- #automation
